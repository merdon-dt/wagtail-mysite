{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block content %}
<div class="container mt-5">
  <div class="row">
    <div class="col-12">

      <!-- Blog Title -->
      <h1 class="mb-4">{{ self.blog_title }}</h1>

      <!-- Categories -->
      {% if self.categories.count %}
        <div class="mb-3">
          <strong>Categories:</strong>
          {% for cat in self.categories.all %}
            <a href="{{ self.get_parent.url }}?category={{ cat.slug }}">
              {{ cat.name }}
            </a>{% if not forloop.last %}, {% endif %}
          {% endfor %}
        </div>
      {% endif %}

      <!-- Author Info -->
      {% if self.author_tags.all %}
        <ul class="list-unstyled d-flex gap-3 align-items-center">
          {% for iter in self.author_tags.all %}
            {% image iter.author.author_image fill-50x50 as img %}
            <li>
              <img src="{{ img.url }}" alt="{{ img.alt }}" class="rounded-circle" />
              <h5>
                {{ iter.author.author_name }}
                {% if iter.author.author_website %}
                  <a href="{{ iter.author.author_website }}" target="_blank">(website)</a>
                {% endif %}
              </h5>
            </li>
          {% endfor %}
        </ul>
      {% endif %}

      <!-- Blog Main Image -->
      {% if self.blog_image %}
        {% image self.blog_image fill-800x400 as blog_img %}
        <img src="{{ blog_img.url }}" alt="{{ blog_img.alt }}" class="img-fluid mb-4 rounded shadow" />
      {% endif %}

      <!-- StreamField Content -->
      <div class="blog-stream-content">
        {{ self.content }}
      </div>

    </div>
  </div>
</div>
{% endblock %}
